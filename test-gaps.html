<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Gaps - DCP Migration Testing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <i class="bi bi-arrow-repeat me-2"></i>
                DCP Migration Testing
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="characters.html">Characters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="gherkin-scenarios.html">Test Scenarios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="migration-testing-challenges.html">Testing Challenges</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="test-gaps.html">Test Gaps</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="staking-contract-security-review.html">Security Review</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="card mb-4">
                    <div class="card-header bg-danger text-white">
                        <h1 class="h3 mb-0">Critical Test Gaps</h1>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-warning">
                            <i class="bi bi-exclamation-triangle-fill me-2"></i>
                            <strong>Target Date: June 17th</strong> - These gaps must be addressed before the migration deadline.
                        </div>

                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 10%">Priority</th>
                                        <th style="width: 45%">Gap</th>
                                        <th style="width: 45%">Impact & Context</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-danger">
                                        <td><strong>1</strong></td>
                                        <td>
                                            <strong>Staking Contract Flows Missing</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Deposit/withdraw scenarios</li>
                                                <li>Variable-rate reward calculations</li>
                                                <li>"Leave dust" rule implementation</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Staking is on the critical path; compounding algorithm still in refinement.
                                            Risks untested UI & smart-contract edge cases.
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><strong>2</strong></td>
                                        <td>
                                            <strong>Base-EOA Onboarding/Off-boarding</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Import existing DCP to Base EOA</li>
                                                <li>Off-board back to mainnet</li>
                                                <li>Failure mode handling</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Engineering chose Base EOA to simplify the hop; needs comprehensive testing
                                            of both directions and error recovery.
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><strong>3</strong></td>
                                        <td>
                                            <strong>Gas-Fee UX & Insufficient ETH Cases</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Zero ETH wallet scenarios</li>
                                                <li>User warning systems</li>
                                                <li>Dust balance handling</li>
                                            </ul>
                                        </td>
                                        <td>
                                            ETH on Base L2 identified as user pain-point; need scenarios that handle
                                            insufficient gas and provide clear user guidance.
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><strong>4</strong></td>
                                        <td>
                                            <strong>Exchange Integration Testing</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>BitMart integration</li>
                                                <li>Bitrue integration</li>
                                                <li>Token deposit/withdrawal endpoints</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Partners need block height for integration; requires sanity tests for
                                            token deposit/withdrawal endpoints post-cutover.
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><strong>5</strong></td>
                                        <td>
                                            <strong>Load & Concurrency Testing</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Multi-user scenarios</li>
                                                <li>Rate limiting</li>
                                                <li>Database locking</li>
                                                <li>Base RPC throttling</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Launch day will see thousands of accounts hitting claim endpoint;
                                            risk of system overload or throttling.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h2 class="h4 mt-5 mb-3">High Priority Gaps</h2>
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 10%">Priority</th>
                                        <th style="width: 45%">Gap</th>
                                        <th style="width: 45%">Impact & Context</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>6</strong></td>
                                        <td>
                                            <strong>Chainlink Oracle & APR Logic</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Variable APR calculations</li>
                                                <li>Rate change simulations</li>
                                                <li>Out-of-bounds handling</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Prime-rate + 1% reward model requires testing of rate changes
                                            and oracle data edge cases.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>7</strong></td>
                                        <td>
                                            <strong>Staking Contract Security</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Re-entrancy protection</li>
                                                <li>Authorization checks</li>
                                                <li>Race conditions</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Security review needed for staking-specific threats,
                                            separate from migration testing.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>8</strong></td>
                                        <td>
                                            <strong>Bridging Flows</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Base App-chain ↔ Base mainnet</li>
                                                <li>Base mainnet ↔ L1 Ethereum</li>
                                                <li>Asset stranding prevention</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Users may bridge to access DEX liquidity;
                                            bridge failure could strand assets.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>9</strong></td>
                                        <td>
                                            <strong>Mobile & Safari Coverage</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Safari desktop testing</li>
                                                <li>iOS WalletConnect</li>
                                                <li>In-app browser scenarios</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Matrix lacks explicit test results for Safari
                                            and mobile browser edge cases.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>10</strong></td>
                                        <td>
                                            <strong>Accessibility & Localization</strong>
                                            <ul class="mb-0 mt-2">
                                                <li>Screen reader compatibility</li>
                                                <li>Keyboard navigation</li>
                                                <li>Internationalization</li>
                                            </ul>
                                        </td>
                                        <td>
                                            Public comms plan targets broad audience;
                                            basic a11y and i18n checks needed.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h2 class="h4 mt-5 mb-3">Action Items & Verification</h2>
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 5%">#</th>
                                        <th style="width: 35%">Action</th>
                                        <th style="width: 30%">Owner</th>
                                        <th style="width: 30%">Verification Method</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-danger">
                                        <td>1</td>
                                        <td>
                                            Add BDD "Staking" feature file covering:
                                            <ul class="mb-0 mt-2">
                                                <li>Stake/unstake flows</li>
                                                <li>Reward accrual & claims</li>
                                                <li>Gas-fail rollback</li>
                                            </ul>
                                        </td>
                                        <td>Smart Contract Team + QA</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Unit-test contract</li>
                                                <li>Cypress E2E recording</li>
                                                <li>Dashboard update</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td>2</td>
                                        <td>
                                            Write onboarding/off-boarding Gherkin scenarios:
                                            <ul class="mb-0 mt-2">
                                                <li>Social-login flows</li>
                                                <li>Wallet-only paths</li>
                                                <li>Wrong EOA recovery</li>
                                            </ul>
                                        </td>
                                        <td>Frontend Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Demo video</li>
                                                <li>Pass/fail table</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td>3</td>
                                        <td>
                                            Create gas-fee edge-case harness:
                                            <ul class="mb-0 mt-2">
                                                <li>ETH balance simulation</li>
                                                <li>Flow re-runs</li>
                                            </ul>
                                        </td>
                                        <td>QA Automation</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Add "Gas-fail" badge</li>
                                                <li>Dashboard tracking</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td>4</td>
                                        <td>
                                            Exchange integration testing:
                                            <ul class="mb-0 mt-2">
                                                <li>Sandbox coordination</li>
                                                <li>Smoke tests</li>
                                            </ul>
                                        </td>
                                        <td>DevOps + Exchange Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>API receipts</li>
                                                <li>Dashboard updates</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td>5</td>
                                        <td>
                                            Load testing:
                                            <ul class="mb-0 mt-2">
                                                <li>200 req/s for 5 min</li>
                                                <li>Claim & staking endpoints</li>
                                            </ul>
                                        </td>
                                        <td>DevOps</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>95th percentile latency</li>
                                                <li>Baseline comparison</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>6</td>
                                        <td>
                                            Chainlink oracle testing:
                                            <ul class="mb-0 mt-2">
                                                <li>Rate feed stubs</li>
                                                <li>APR cap logic</li>
                                            </ul>
                                        </td>
                                        <td>Smart Contract Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Coverage report</li>
                                                <li>Test results</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>7</td>
                                        <td>
                                            Security testing:
                                            <ul class="mb-0 mt-2">
                                                <li>Re-entrancy probes</li>
                                                <li>Signature replay</li>
                                                <li>Race conditions</li>
                                            </ul>
                                        </td>
                                        <td>Security Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>New feature file</li>
                                                <li>Test results</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>8</td>
                                        <td>
                                            Bridge testing:
                                            <ul class="mb-0 mt-2">
                                                <li>LayerZero integration</li>
                                                <li>Base bridge UI</li>
                                            </ul>
                                        </td>
                                        <td>Frontend + Infra</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Bridge round-trip video</li>
                                                <li>Test results</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>9</td>
                                        <td>
                                            Safari testing:
                                            <ul class="mb-0 mt-2">
                                                <li>macOS + iOS</li>
                                                <li>TrustWallet integration</li>
                                            </ul>
                                        </td>
                                        <td>QA Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Compatibility matrix</li>
                                                <li>Test results</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>10</td>
                                        <td>
                                            Accessibility testing:
                                            <ul class="mb-0 mt-2">
                                                <li>axe-core audit</li>
                                                <li>i18n testing</li>
                                            </ul>
                                        </td>
                                        <td>Frontend Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Audit score</li>
                                                <li>Violation list</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>11</td>
                                        <td>
                                            Role preservation testing:
                                            <ul class="mb-0 mt-2">
                                                <li>Moderator flags</li>
                                                <li>Validator status</li>
                                            </ul>
                                        </td>
                                        <td>Backend Team</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Assertion script</li>
                                                <li>Dashboard table</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>12</td>
                                        <td>
                                            Support documentation:
                                            <ul class="mb-0 mt-2">
                                                <li>Error code catalog</li>
                                                <li>Discord integration</li>
                                            </ul>
                                        </td>
                                        <td>Comms + QA</td>
                                        <td>
                                            <ul class="mb-0">
                                                <li>Published catalog</li>
                                                <li>Support team review</li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="alert alert-info mt-4">
                            <h5 class="alert-heading">Next Steps</h5>
                            <p class="mb-0">
                                Critical gaps (1-5) must be addressed before June 17th. High priority items (6-12) should be 
                                completed as soon as possible after the critical path items. All test results and verification 
                                artifacts should be documented on the dashboard.
                            </p>
                        </div>

                        <div class="card mt-5">
                            <div class="card-header bg-success text-white">
                                <h2 class="h4 mb-0">Gherkin Scenarios Addressing Test Gaps</h2>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-success">
                                    <h5 class="alert-heading">Implementation Progress</h5>
                                    <p class="mb-0">
                                        The following Gherkin scenarios have been developed to address the identified test gaps.
                                        Each feature file targets specific gaps and includes comprehensive test coverage.
                                    </p>
                                </div>

                                <div class="accordion" id="gherkinAccordion">
                                    <!-- Staking Feature -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#stakingFeature">
                                                <strong>Staking Contract Flows</strong> - Addresses Gap #1
                                            </button>
                                        </h2>
                                        <div id="stakingFeature" class="accordion-collapse collapse show" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <p class="text-muted mb-3">Covers critical staking operations including deposit/withdraw, variable-rate rewards, and dust handling.</p>
                                                <pre class="bg-light p-3 rounded"><code># features/staking.feature
@critical @staking @mainnetReady
Feature: Staking Talent on the new Base app‑chain

  Background:
    Given the migration snapshot has executed successfully
    And "Kanley" has 1 000 TALNT in her Base EOA
    And "Kanley" is connected to the DCP web app via Web3Auth

  @happyPath
  Scenario: Stake full balance minus required "dust" for fees
    When Kanley clicks "Stake" and enters "1000" TALNT
    Then the UI warns that at least 5 TALNT must remain for fees
    When Kanley adjusts the amount to "995" TALNT and confirms
    Then a staking transaction is broadcast to the Base app‑chain
    And Kanley's staked balance is "995" TALNT
    And her unstaked balance is "5" TALNT
    And the activity log shows "Stake successful"

  @rewardAccrual
  Scenario: Accrue variable‑rate rewards for one epoch
    Given Kanley has staked 500 TALNT
    And the Chainlink oracle reports a prime inflation rate of 2.5 %
    When one staking epoch elapses
    Then Kanley's pending rewards equal 500 × (0.025 + 0.01) = 17.5 TALNT ±0.01

  @partialUnstake
  Scenario: Partially unstake during lock‑up
    Given Kanley has 500 TALNT staked for at least one full epoch
    When she requests to unstake "200" TALNT
    Then the contract queues an exit transaction
    And the UI shows an estimated unlock time ≤ 24 h
    When the unlock period passes
    And Kanley claims the 200 TALNT
    Then her unstaked balance increases by 200 TALNT
    And her staked balance decreases accordingly

  @fullUnstake
  Scenario: Attempt to unstake entire balance leaving zero for gas
    Given Kanley has 5 TALNT unstaked and 995 TALNT staked
    When she selects "Unstake max"
    Then the UI blocks the action with error "INSUFFICIENT_DUST"
    And suggests leaving at least 5 TALNT unstaked</code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Onboarding/Offboarding Feature -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onboardingFeature">
                                                <strong>Base EOA Onboarding/Offboarding</strong> - Addresses Gap #2
                                            </button>
                                        </h2>
                                        <div id="onboardingFeature" class="accordion-collapse collapse" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <div class="alert alert-success mb-3">
                                                    <h6 class="alert-heading">Current Implementation Status</h6>
                                                    <p class="mb-0">
                                                        <i class="bi bi-check-circle-fill me-2"></i>
                                                        <strong>EOA Claiming Flow:</strong> The current implementation successfully handles Base EOA creation and token claiming for all authentication methods (Google, X, Apple ID).
                                                    </p>
                                                </div>
                                                <div class="alert alert-warning mb-3">
                                                    <h6 class="alert-heading">Remaining Gap</h6>
                                                    <p class="mb-0">
                                                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                                                        <strong>Offboarding to Mainnet:</strong> The offboarding flow from Base EOA back to Ethereum L1 is not yet implemented. This is the critical missing piece that needs to be addressed.
                                                    </p>
                                                </div>
                                                <p class="text-muted mb-3">The following scenario focuses on the missing offboarding functionality:</p>
                                                <pre class="bg-light p-3 rounded"><code># features/onboarding_offboarding_base_eoa.feature
@critical @onboarding
Feature: Seamless onboarding and off‑boarding using Base EOAs

  Background:
    Given the DCP migration banner is visible
    And "Skipper" is a legacy DCP user with a social‑login wallet

  @offBoard
  Scenario: User off‑boards to Ethereum L1
    Given "Keith" has an existing Base EOA with 2 000 TALNT
    When Keith clicks "Off‑board → Mainnet"
    Then the bridge modal explains fees in ETH and ETA
    And Keith accepts the cost summary
    When the bridging transaction confirms
    Then Etherscan shows 2 000 TALNT in Keith's L1 wallet</code></pre>
                                                <div class="alert alert-info mt-3">
                                                    <h6 class="alert-heading">Implementation Priority</h6>
                                                    <p class="mb-0">
                                                        While the EOA claiming flow is working well, the offboarding functionality is critical for users who need to move their tokens back to Ethereum L1. This should be implemented before the June 17th deadline.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Gas Fee Edge Cases -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#gasFeature">
                                                <strong>Gas Fee Edge Cases</strong> - Addresses Gap #3
                                            </button>
                                        </h2>
                                        <div id="gasFeature" class="accordion-collapse collapse" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <p class="text-muted mb-3">Tests gas-fee handling and insufficient ETH scenarios.</p>
                                                <pre class="bg-light p-3 rounded"><code># features/gas_fee_edge_cases.feature
@critical @gasFees
Feature: Gas‑fee guard‑rails during staking and bridging

  Background:
    Given "Herner" holds exactly 0.00009 ETH in his Base EOA
    And the minimum gas required for an L2 transaction is 0.0001 ETH

  @bridgeBlock
  Scenario: Bridge attempt fails gracefully when ETH is insufficient
    When Herner clicks "Bridge TALNT to L1"
    Then the frontend displays error "NOT_ENOUGH_ETH"
    And the action button is disabled

  @stakeBlock
  Scenario: Staking blocked with zero ETH balance
    Given Herner has 0.00000 ETH in his Base EOA
    When he tries to stake 10 TALNT
    Then the UI shows error "GAS_BALANCE_ZERO"
    And links to "Get ETH on Base" help article</code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Security Testing -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#securityFeature">
                                                <strong>Security Testing</strong> - Addresses Gap #7
                                            </button>
                                        </h2>
                                        <div id="securityFeature" class="accordion-collapse collapse" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <p class="text-muted mb-3">White-hat testing scenarios for staking contract security.</p>
                                                <pre class="bg-light p-3 rounded"><code># features/herner_staking_security.feature
@security @staking
Feature: White‑hat exploits targeting the staking contract

  Background:
    Given the staking contract is deployed at address "<addr>"
    And "Herner" controls a malicious contract "EvilStake"

  @reentrancy
  Scenario: Re‑entrancy attack during unstake
    When Herner deposits 100 TALNT via EvilStake
    And EvilStake triggers a recursive unstake call
    Then the transaction is reverted with "REENTRANCY_GUARD"
    And Herner's staked balance remains 100 TALNT

  @oracleManipulation
  Scenario: Oracle returns extreme APR value
    Given the Chainlink oracle stub returns 999 % APR
    When reward calculation runs
    Then the contract caps APR at 15 %
    And emits event "APR_CAPPED"

  @sigReplay
  Scenario: Off‑chain signed unstake replayed twice
    Given Kanley signs an unstake permit for 300 TALNT
    When Herner submits the permit
    Then it executes successfully
    When Herner submits the same permit again
    Then the transaction reverts with "NONCE_ALREADY_USED"</code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Bridge Testing -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#bridgeFeature">
                                                <strong>Bridge Testing</strong> - Addresses Gap #8
                                            </button>
                                        </h2>
                                        <div id="bridgeFeature" class="accordion-collapse collapse" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <p class="text-muted mb-3">LayerZero bridge testing between Base L2 and app-chain.</p>
                                                <pre class="bg-light p-3 rounded"><code># features/bridge_layerzero_base.feature
@high @bridging
Feature: Bridging TALNT via LayerZero between Base L2 and Base app‑chain

  Background:
    Given "Sandra" has 1 000 TALNT on Base L2
    And the bridge UI is reachable at "/bridge"

  @roundTrip
  Scenario: Round‑trip bridge of 100 TALNT
    When Sandra bridges 100 TALNT to the DCP app‑chain
    Then the L2 txn hash is recorded
    And the DCP app‑chain wallet shows +100 TALNT within 2 minutes
    When Sandra sends 100 TALNT back to Base L2
    Then her final app‑chain balance returns to the initial value

  @slowRelayer
  Scenario: Delayed relayer triggers status polling
    Given the relayer is artificially delayed by 30 minutes
    When Sandra bridges 50 TALNT
    Then the UI shows "Pending (relayer queue)" status
    And auto‑refreshes every 10 seconds until completion</code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Safari Compatibility -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#safariFeature">
                                                <strong>Safari Compatibility</strong> - Addresses Gap #9
                                            </button>
                                        </h2>
                                        <div id="safariFeature" class="accordion-collapse collapse" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <p class="text-muted mb-3">Safari and Trust Wallet integration testing.</p>
                                                <pre class="bg-light p-3 rounded"><code># features/compat_safari_walletconnect.feature
@high @crossBrowser
Feature: Safari (iOS/macOS) + Trust Wallet compatibility

  Background:
    Given "Skipper" is on Safari version "17.0" on macOS
    And "Skipper" uses Trust Wallet via WalletConnect

  @tokenClaim
  Scenario: Claiming TALNT in Safari with Trust Wallet
    When Skipper scans the QR code
    Then Trust Wallet shows the claim transaction
    When Skipper confirms
    Then the claim succeeds
    And the DCP app displays "Success" without UI breakage</code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Chainlink Oracle -->
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#oracleFeature">
                                                <strong>Chainlink Oracle</strong> - Addresses Gap #6
                                            </button>
                                        </h2>
                                        <div id="oracleFeature" class="accordion-collapse collapse" data-bs-parent="#gherkinAccordion">
                                            <div class="accordion-body">
                                                <p class="text-muted mb-3">APR calculation and oracle integration testing.</p>
                                                <pre class="bg-light p-3 rounded"><code># features/chainlink_apr_oracle.feature
@high @oracle
Feature: APR calculation with Chainlink prime‑rate oracle

  Background:
    Given the oracle adaptor fetches `primeRate` once per epoch

  @normal
  Scenario: Normal prime rate input
    Given primeRate = 2.75 %
    When the epoch ends
    Then the contract sets APR = 3.75 % (prime + 1)

  @zeroRate
  Scenario: Oracle returns zero
    Given primeRate = 0.00 %
    When the epoch ends
    Then APR = 1.00 % (minimum)

  @outlier
  Scenario: Oracle spike filtered
    Given primeRate = 47.00 %
    When the epoch ends
    Then APR is capped at 15.00 %
    And event "APR_CAPPED" is emitted</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="alert alert-info mt-4">
                                    <h5 class="alert-heading">Implementation Status</h5>
                                    <p class="mb-0">
                                        These Gherkin scenarios directly address 7 of the 12 identified gaps. The remaining gaps
                                        (4, 5, 10, 11, and 12) require different types of testing approaches (load testing,
                                        accessibility testing, and support documentation) that are better suited to other
                                        testing frameworks and tools.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-light text-center text-lg-start mt-5">
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.05);">
            © 2025 DCP Migration Testing Dashboard
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 